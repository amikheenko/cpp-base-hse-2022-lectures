# –õ–µ–∫—Ü–∏—è 18

–î–µ–±–∞–≥ (debugger) ‚Äî –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø—Ä–æ–≥—Ä–∞–º–º—É –≤ —Ç–∞–∫–æ–º —Ñ–æ—Ä–º–∞—Ç–µ, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ—â–µ –≤—Å–µ–≥–æ –æ—Ç–ª–∞–∂–∏–≤–∞—Ç—å;

–î–æ–ø–æ–ª–Ω—è–µ—Ç—Å—è –∫–æ–¥, —á—Ç–æ–±—ã –º—ã –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ –¥–µ–±–∞–≥–≥–µ—Ä–∞ –≤–∏–¥–µ–ª–∏, –≤ –∫–∞–∫–æ–º –ø–æ—Ä—è–¥–∫–µ —É –Ω–∞—Å –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ä–∞–±–æ—Ç–∞ —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –∏ –º–Ω–æ–≥–æ –ª–∏—à–Ω–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π, –º–µ–¥–ª–µ–Ω–Ω–æ

## –ö–∞–∫ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Ç–∞–∫, —á—Ç–æ–±—ã –ø—Ä–æ–≥—Ä–∞–º–º–∞ –±—ã—Å—Ç—Ä–µ–µ?

1. –°–æ–±–∏—Ä–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É –≤ —Ä–µ–∂–∏–º–µ *Release (–¥–∞–ª–µ–µ ‚Äî —Ä–µ–ª–∏–∑)*
    1. –í –∫–æ–Ω—Å–æ–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å –∫–ª—é—á ‚Äú-r‚Äù; –≤ CLion: –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –ø—Ä–æ–µ–∫—Ç–∞ ‚Äî Build, Execution, Deployment ‚Üí CMake ‚Üí ‚ûï¬†(add) –ø—Ä–æ—Ñ–∏–ª—å Release, –¥–∞–ª–µ–µ –º–æ–∂–Ω–æ –Ω–∞–≤–µ—Ä—Ö—É –≤ –ø—Ä–æ–µ–∫—Ç–µ –∑–∞–ø—É—Å–∫–∞—Ç—å –±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–∞–π–ª Release;
    2. –í —Ä–µ–ª–∏ –≤–∫–ª—é—á–∞—é—Ç—Å—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞, –Ω–∞ –ø–æ—Ä—è–¥–æ–∫ –±—ã—Å—Ç—Ä–µ–µ, —á–µ–º –≤ –¥–µ–±–∞–≥–µ
    3. –ö–æ–º–ø–∏–ª—è—Ç–æ—Ä—ã —É–º–µ—é—Ç:
        - –£–±–∏—Ä–∞—Ç—å –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä–æ–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –ø—Ä–æ–≥—Ä–∞–º–º–µ, –µ—Å–ª–∏ ‚Äú—Å–Ω–∞—Ä—É–∂–∏‚Äù –Ω–µ—Ç —Ä–∞–∑–Ω–∏—Ü—ã –º–µ–∂–¥—É –∫–æ–¥–æ–º —Å —ç—Ç–∏–º–∏ –≤—ã—Ä–∞–∂–µ–Ω–∏—è–º–∏ –∏–ª–∏ –Ω–µ—Ç
        - –£–¥–∞–ª–∏—Ç—å –≤–µ–∫—Ç—É, –µ—Å–ª–∏ –æ–Ω–∞ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ UB, —Ç–æ –µ—Å—Ç—å –≤ –Ω–µ–π –º–æ–∂–µ—Ç –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å –≤—Å–µ, —á—Ç–æ —É–≥–æ–¥–Ω–æ ‚Äî ‚Äú–Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞—Ç—å‚Äù —Ä–∞–≤–Ω–æ—Å–∏–ª—å–Ω–æ UB;
        - –ü–µ—Ä–µ—Å—Ç–∞–≤–ª—è—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –º–µ—Å—Ç–∞–º–∏, –µ—Å–ª–∏ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä —Å—á–∏—Ç–∞–µ—Ç, —á—Ç–æ –æ–Ω–∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã –ø–æ –¥–∞–Ω–Ω—ã–º (–ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π –Ω–µ –º–µ–Ω—è–µ—Ç –≤–Ω–µ—à–Ω–∏–µ –ø—Ä–æ—è–≤–ª–µ–Ω–∏—è –∫–æ–¥–∞ –≤ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ —Å –∫–æ–¥–æ–º –¥–æ –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∏)
        - –ü—Ä–∏–º–µ–Ω—è—Ç—å –≤–µ–∫—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ (–¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π —Å –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –¥–∞–±–ª–æ–≤);
            
            –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ –ø–æ—Å—á–∏—Ç–∞—Ç—å —Å–∫–∞–ª—è—Ä–Ω–æ–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –≤–µ–∫—Ç–æ—Ä–æ–≤ `a` –∏ `b`, —Ç–æ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –º–æ–∂–µ—Ç –∑–∞ –æ–¥–Ω—É –æ–ø–µ—Ä–∞—Ü–∏—é –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ –ø–µ—Ä–µ–º–Ω–æ–∂–∏—Ç—å –ø–µ—Ä–≤—ã–µ 15 (—É—Å–ª–æ–≤–Ω–æ, –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≤–µ—Ä—Å–∏–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π) —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤–µ–∫—Ç–æ—Ä–æ–≤ 
            
        - –£–¥–∞–ª—è—Ç—å –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–∏ –Ω–µ –Ω—É–∂–Ω—ã –∏ –º–Ω–æ–≥–æ —á–µ–≥–æ –¥—Ä—É–≥–æ–≥–æ
    4. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–æ–µ–∫—Ç–∞ –∑–∞–º–µ—Ä—è–µ–º –≤ —Ä–µ–ª–∏–∑–µ
    5. –¢–µ—Å—Ç–∏—Ä—É–µ–º –Ω–∞ –Ω–∞—Å—Ç–æ—è—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö, –∏–Ω–∞—á–µ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –º–æ–∂–µ—Ç —Å–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–π —Ç–µ—Å—Ç;

–ù–∞—É—á–∏–º—Å—è –∏–∑–º–µ—Ä—è—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫–æ–¥–∞

### Namespace `std::chrono`

–î–æ–±–∞–≤–∏–º header `<chrono>`

–í–Ω—É—Ç—Ä–∏ –ª–µ–∂–∞—Ç –∫–ª–∞—Å—Å—ã, —Å—Ç—Ä—É–∫—Ç—É—Ä—ã, –ª–∏—Ç–µ—Ä–∞–ª—ã ‚Äî —Ç–∞–π–º–µ—Ä—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º:

- `std::chrono::system_clock` ‚Äî —Å–∏—Å—Ç–µ–º–Ω—ã–π —Ç–∞–π–º–µ—Ä;
    - –ù–µ–¥–æ—Å—Ç–∞—Ç–æ–∫: –º–æ–∂–µ—Ç –ø–µ—Ä–µ–≤–æ–¥–∏—Ç—å –≤—Ä–µ–º—è –Ω–∞–∑–∞–¥ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —á–∞—Å–æ–≤–æ–≥–æ –ø–æ—è—Å–∞ –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–µ);
- `std::chrono::steady_clock` ‚Äî –º–æ–Ω–æ—Ç–æ–Ω–Ω—ã–π —Ç–∞–π–º–µ—Ä, –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —É–±—ã–≤–∞–µ—Ç;
    - –ß–∞—â–µ –≤—Å–µ–≥–æ, —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è ‚Äî –≤—Ä–µ–º—è —Å –∑–∞–≥—Ä—É–∑–∫–∏ –û–°;
- `std::chrono::high_resolution_clock` ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–∞–∏–º–µ–Ω—å—à–∏–π –∏–∑–º–µ—Ä—è–µ–º—ã–π –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–º –∏–Ω—Ç–µ—Ä–≤–∞–ª;
    - –ü–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–æ –∑–∞–≤–∏—Å–∏–º—ã–π –∫–æ–¥ (–Ω–µ–ª—å–∑—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –ø–æ—Ä—Ç–∏—Ä—É–µ–º—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º–∞—Ö);
- std::chrono::timepoint ‚Äî –º–æ–º–µ–Ω—Ç –≤–æ –≤—Ä–µ–º–µ–Ω–∏;
- std::chrono::duration ‚Äî –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤ –µ–¥–∏–Ω–∏—Ü–∞—Ö –≤—Ä–µ–º–µ–Ω–∏;

–°–æ–∑–¥–∞–¥–∏–º –≤–µ–∫—Ç–æ—Ä —Ç–∏–ø–∞ `int` –∑–∞–ø–æ–ª–Ω–∏–º –µ–≥–æ –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —á–∏—Å–µ–ª –∏ 

```cpp
#include <chrono>

int main() {
    std::vector<int> values;
	
	  for (size_t i = 0; i < 100000000; ++i) {
	    values.push_back(i);
	  }
	
	 
	  std::cout << std::accumulate(values.begin(), values.end(), 0) << std::endl; // —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–º–µ–Ω—è–µ—Ç –∫ –Ω–∞—á–∞–ª—å–Ω–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é (–≤ –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ - 0) –æ–ø–µ—Ä–∞—Ç–æ—Ä + —Å —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ –≤–µ–∫—Ç–æ—Ä–∞
	  return 0;
}
```

–ò–∑–º–µ—Ä–∏–º, —Å–∫–æ–ª—å–∫–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —ç—Ç–æ—Ç –∫–æ–¥

```cpp
#include <chrono>

int main() {
    std::vector<int> values;
	
		auto start = std::chrono::steady_clock::now();
	  for (size_t i = 0; i < 100000000; ++i) {
	    values.push_back(i);
	  }
		auto end = std::chrono::steady_clock::now();
		
		std::cout << (end - start).count() << std::endl;  // —Ç–∞–∫ –ø–æ–ª—É—á–∞–µ–º –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫–æ–¥–∞, –º–µ—Ç–æ–¥ .count() –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—Å–ª–æ–≤–Ω—ã—Ö –µ–¥–∏–Ω–∏—Ü duration
	 
	  
		std::cout << std::accumulate(values.begin(), values.end(), 0) << std::endl; // —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–º–µ–Ω—è–µ—Ç –∫ –Ω–∞—á–∞–ª—å–Ω–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é (–≤ –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ - 0) –æ–ø–µ—Ä–∞—Ç–æ—Ä + —Å —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ –≤–µ–∫—Ç–æ—Ä–∞
	  return 0;
}
```

`std::chrono::steady_clock::now()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —à–∞–±–ª–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É `std::chrono::time_point,` –∫–æ—Ç–æ—Ä–∞—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–∞ —Ç–∏–ø–æ–º —Ç–∞–π–º–µ—Ä–∞ –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø—Ä–æ—à–µ–¥—à–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏:

```cpp
template<
    class Clock,
    class Duration = typename Clock::duration
> class time_point;
```

### std::chrono::duration

–ü–æ–π–º–µ–º, –∫–∞–∫ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω `std::chrono::duration`

–≠—Ç–æ —à–∞–±–ª–æ–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å –¥–≤—É–º—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ ‚Äî —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö, –≤ –∫–æ—Ç–æ—Ä—ã—Ö —Ö—Ä–∞–Ω—è—Ç—Å—è –µ–¥–∏–Ω–∏—Ü—ã –≤—Ä–µ–º–µ–Ω–∏, –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ `std::ratio<>` ‚Äî –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –ø—Ä–æ—Å—Ç—É—é –¥—Ä–æ–±—å, –∏–º–µ–µ—Ç —á–∏—Å–ª–∏—Ç–µ–ª—å –∏ –∑–Ω–∞–º–µ–Ω–∞—Ç–µ–ª—å

```cpp

int main() {
    std::vector<int> values;
	
	  auto start = std::chrono::steady_clock::now();
	  for (size_t i = 0; i < 100000000; ++i) {
	    values.push_back(i);
	  }
		auto end = std::chrono::steady_clock::now();
		
		//std::ratio<1, 1> - —Å–µ–∫—É–Ω–¥–∞, —á–∏—Å–ª–∏—Ç–µ–ª—å 1, –∑–Ω–∞–º–µ–Ω–∞—Ç–µ–ª—å 1
		//std::ratio<1, 1000> - –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞, —á–∏—Å–ª–∏—Ç–µ–ª—å 1, –∑–Ω–∞–º–µ–Ω–∞—Ç–µ–ª—å 1000
		//std::ratio<1, 1000000> - –º–∏–∫—Ä–æ—Å–µ–∫—É–Ω–¥–∞, —á–∏—Å–ª–∏—Ç–µ–ª—å 1, –∑–Ω–∞–º–µ–Ω–∞—Ç–µ–ª—å 1000000
	
		//std::chrono::duration<int64_t, std::milli> elapsed = end - start; std::milli - —Ç–æ –∂–µ —Å–∞–º–æ–µ , —á—Ç–æ –∏ std::ratio<1, 1000>
		//–≤—ã–¥–∞—Å—Ç –æ—à–∏–±–∫—É, —Ç–∞–∫ –∫–∞–∫ –ø—Ä–∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–∏ –¥—Ä–æ–±–µ–π —Å –±–æ–ª—å—à–∏–º –∑–Ω–∞–º–µ–Ω–∞—Ç–µ–ª–µ–º –≤ –¥—Ä–æ–±–∏ —Å –º–µ–Ω—å—à–∏–º –∑–Ω–∞–º–µ–Ω–∞—Ç–µ–ª–µ–º –¥–∞–µ—Ç –±–æ–ª—å—à—É—é –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å
	
		std::chrono::duration<int64_t, std::nano> elapsed = end - start;
	
		std::cout << elapsed.count() << "ns" << std::endl;  // 
	 
	  
		std::cout << std::accumulate(values.begin(), values.end(), 0) << std::endl;
	  return 0;
}
```

–î–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –Ω–∞–ø–∏—à–µ–º –∫–ª–∞—Å—Å `Timer`

```cpp
class Timer {
public:
    Timer(std::string message) : start_(std::chrono::steady_clock::now()), message_(std::move(std::string message_)) {
	}
	// –ø–µ—Ä–µ–¥–∞–µ–º –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é, —Ç–∞–∫ –∫–∞–∫ –≤—Å–µ —Ä–∞–≤–Ω–æ —Ö–æ—Ç–∏–º —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –ø—Ä–∏–≤–∞—Ç–Ω–æ–µ –ø–æ–ª–µ message_
	// –µ—Å–ª–∏ –ø–µ—Ä–µ–¥–∞—á–µ–º –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é, —Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º std::move. –µ—Å–ª–∏ –ø–µ—Ä–µ–¥–∞–¥—É—Ç const std::string& –Ω–∞ —Å—Ç—Ä–æ–∫—É, —Ç–æ –æ–Ω–∞ —Å–∫–æ–ø–∏—Ä—É–µ—Ç—Å—è –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–µ
	// –∏ std::move –∫–æ–ø–∏—é –∑–∞-move-–∏—Ç, –∞ –µ—Å–ª–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç, —Ç–æ —Å—Ä–∞–∑—É –∑–∞-move-–∏—Ç—Å—è –≤ message

    ~Timer() {
        auto end = std::chrono::steady_clock:::now();
        std::chrono:duration<int64_t, std::nano> elapsed = end - start;
				std::cout << message_ << " " << elapsed.count() << " ns" << std::endl;
		}

private:
    std::chrono::steady_clock::time_point start_;
	  std::string message_;
};
```

–û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Ç–µ–ø–µ—Ä—å –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫:

```cpp
using namespace std::chrono_literals;

int main() {
    std::vector<int> values;

    {
        Timer timer("for");
        for (size_t i = 0; i < 100000000; ++i) {
            values.push_back(i);
						std::this_thread::sleep_for(10ms); // –∏–∑ namespace std::chrono_literals;
						// –∏–ª–∏ —Ç–∞–∫: std::this_thread::sleep_until(std::chrono::steady_clock::now() + 10ms);
        }
    }

    std::cout << std::accumulate(values.begin(), values.end(), 0) << std::endl;
    return 0;
}

// –í—ã–≤–æ–¥:
// for 10071346921 ns
// 499500
```

## –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å –∏ –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å

–í –∫–∞–∫–æ–π-—Ç–æ –º–æ–º–µ–Ω—Ç –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã –ø–µ—Ä–µ—Å—Ç–∞–ª–∏ —É–≤–µ–ª–∏—á–∏–≤–∞—Ç—å —á–∞—Å—Ç–æ—Ç—É (–∏–∑-–∑–∞ —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π), –∞ —Å—Ç–∞–ª–∏ –Ω–∞—Ä–∞—â–∏–≤–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —è–¥–µ—Ä.

> –ü–æ —Å—É—Ç–∏, —è–¥—Ä–æ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ ‚Äî- —ç—Ç–æ –æ—Ç–¥–µ–ª—å–Ω—ã–π –º–∏–Ω–∏-–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä.
> 

–î—Ä—É–≥ —Å –¥—Ä—É–≥–æ–º —è–¥—Ä–∞ –æ–¥–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ –æ–±—ä–µ–¥–∏–Ω–µ–Ω—ã –æ–±—â–∏–º –∫–æ—Ä–ø—É—Å–æ–º –∏ –∫—ç—à–µ–º.  

- –î–ª—è –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–º—è—Ç—å –æ—á–µ–Ω—å –º–µ–¥–ª–µ–Ω–Ω–∞—è. –î–ª—è –º–Ω–æ–≥–∏—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ç–æ–ª—å–∫–æ, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤ –≤ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–µ, –∞ –¥–∞–Ω–Ω—ã–µ –≤ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏ –º–µ–Ω—è—é—Ç—Å—è –Ω–µ —Ç–∞–∫ —á–∞—Å—Ç–æ.
–ü–æ—ç—Ç–æ–º—É —É –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–≤ –µ—Å—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä—ã, –∑–∞—Ç–µ–º –∏–¥—É—Ç L1-–∫—ç—à (–º–∞–ª–µ–Ω—å–∫–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞–º—è—Ç–∏, –Ω–∞—Ö–æ–¥—è—â–µ–µ—Å—è –Ω–∞ —è–¥—Ä–µ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞, –∫ –∫–æ—Ç–æ—Ä–æ–º—É –æ—á–µ–Ω—å –±—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø), –ø–æ—Å–ª–µ L2-–∫—ç—à (—Ä–∞–∑–º–µ—Ä –ø–∞–º—è—Ç–∏ —á—É—Ç—å –ø–æ–±–æ–ª—å—à–µ, –Ω–æ —Å –±–æ–ª–µ–µ –º–µ–¥–ª–µ–Ω–Ω—ã–º –¥–æ—Å—Ç—É–ø–æ–º, —á–µ–º —É L1-–∫—ç—à–∞) –∏, –Ω–∞–∫–æ–Ω–µ—Ü, L3-–∫—ç—à (–µ—â—ë –±–æ–ª—å—à–µ –ø–∞–º—è—Ç–∏ –∏ –º–µ–¥–ª–µ–Ω–Ω–µ–π –¥–æ—Å—Ç—É–ø –∫ –Ω–µ–π, –Ω–æ –≤—Å—ë –µ—â—ë –±—ã—Å—Ç—Ä–µ–µ, —á–µ–º –∫ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏). –ü—Ä–æ—Ü–µ—Å—Å–æ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –¥–∞–Ω–Ω—ã–º–∏ –Ω–µ –Ω–∞–ø—Ä—è–º—É—é, –∞ —á–µ—Ä–µ–∑ –∫—ç—à.
- Hyperthreading ‚Äî –Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–µ—Ç–∞–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –æ—Ç–≤–µ—á–∞—é—Ç –∑–∞ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è 4 –∫–æ–º–ø–ª–µ–∫—Ç–∞, –∞ –¥–µ—Ç–∞–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –æ—Ç–≤–µ—á–∞—é—Ç –∑–∞ —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ –¥–≤–∞ —Ä–∞–∑–∞ –±–æ–ª—å—à–µ. –ë–æ–ª—å—à—É—é —á–∞—Å—Ç—å –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–Ω–∏–º–∞—é—Ç –Ω–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è, –∞ –ø–µ—Ä–µ–∫–ª–∞–¥—ã–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –ø–∞–º—è—Ç–∏ –≤ –∫—ç—à, –∏–∑ –∫—ç—à–∞ –≤ —Ä–µ–≥–∏—Å—Ç—Ä –∏ —Ç.–¥.  –£ —è–¥—Ä–∞ —Å hyperthreading –æ–¥–Ω–∞ —á–∞—Å—Ç—å –º–æ–∂–µ—Ç –∑–∞–Ω–∏–º–∞—Ç—å—Å—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è–º–∏, –∞ –¥—Ä—É–≥–∞—è ‚Äî- –≤–≤–æ–¥–æ–º-–≤—ã–≤–æ–¥–æ–º –≤ –ø–∞–º—è—Ç—å.

–ò–Ω–æ–≥–¥–∞ –∑–∞–¥–∞—á—É –º–æ–∂–Ω–æ —Ä–∞–∑–¥–µ–ª–∏—Ç—å –Ω–∞ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ –ø–æ–¥–∑–∞–¥–∞—á–∏ –∏ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –Ω–∏–º–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∫–∞–∂–¥—ã–π –ø–∏–∫—Å–µ–ª—å –æ—Ç–¥–µ–ª—å–Ω–æ).

–û–±—ã—á–Ω–æ –ø—Ä–æ–≥—Ä–∞–º–º—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ (—Å—Ç—Ä–æ—á–∫–∞ –∑–∞ —Å—Ç—Ä–æ—á–∫–æ–π). –î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –∑–∞–ø—É—Å—Ç–∏—Ç—å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é –∑–∞–¥–∞—á—É, –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–µ –µ—Å—Ç—å —Ñ—É–Ω–∫—Ü–∏—è `std::async()`.

```cpp
using namespace std::chrono_literals;

int Calc(int x) {
		int result = x * x;
		std::cout << result << std::endl;
		std::this_thread::sleep_for(1s);
    return result;
}

int main() {
		
		auto future = std::async(Calc, 10); // –ø–µ—Ä–µ–¥–∞—ë–º —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—é –∏ –Ω–∞–±–æ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è –Ω–µ—ë
		// std::future<int> future = std::async(Calc, 10); // —Ñ—É–Ω–∫—Ü–∏—è std::async –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –æ–±—ä–µ–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π –∏–º–µ–µ—Ç —Ç–∏–ø std::future
	
		// future.wait() - –º–µ—Ç–æ–¥, –∫–æ—Ç–æ—Ä—ã–π "–≥–æ–≤–æ—Ä–∏—Ç –¥–æ–∂–¥–∞—Ç—å—Å—è", –ø–æ–∫–∞ –≤–æ future –Ω–µ –ø–æ–ª–æ–∂–∞—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
		// future.get() - –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—É—á–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –∫–æ—Ç–æ—Ä—ã–π –ª–µ–∂–∏—Ç –≤–æ future
		// –û–±–∞ –º–µ—Ç–æ–¥–∞ —è–≤–ª—è—é—Ç—Å—è "–±–ª–æ–∫–∏—Ä—É—é—â–∏–º–∏", —Ç–æ –µ—Å—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º–∞ –±—É–¥–µ—Ç –∂–¥–∞—Ç—å, –ø–æ–∫–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –Ω–µ –∑–∞–∫–æ–Ω—á–∏—Ç —Å–≤–æ–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –∏ –Ω–µ –ø–æ–ª–æ–∂–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤–æ future.

		std::cout << "Result: " << future.get() << std::endl;
		return 0;
}

// –í—ã–≤–æ–¥:
// Result: 100
// 100
```

`std::future` ‚Äî —á—Ç–æ-—Ç–æ –≤—Ä–æ–¥–µ —É–∫–∞–∑–∞—Ç–µ–ª—è –Ω–∞ –±—É–¥—É—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –ø–æ–ª—É—á–µ–Ω –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏. –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω —Ç–∏–ø–æ–º –≤–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è.

<aside>
üí° `std::future` –º–æ–∂–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –∏ void

</aside>

–î–æ–±–∞–≤–∏–º –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–∞: 

```cpp
using namespace std::chrono_literals;

int Calc(int x) {
		int result = x * x;
    return result;
}

int main() {

		std::future<int> future1 = std::async(Calc, 10);
		std::future<int> future2 = std::async(Calc, 20);

		std::cout << "Result: " << future1.get() << std::endl;
		std::cout << "Result: " << future2.get() << std::endl;

		return 0;
}

// –í—ã–≤–æ–¥:
// Result: 100
// Result: 400
```

–í—ã—á–∏—Å–ª–µ–Ω–∏—è `Calc(10)` –∏ `Calc(20)` –±—É–¥—É—Ç –ø—Ä–æ—Ö–æ–¥–∏—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ. `std::future` –Ω–µ–ª—å–∑—è –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å, –Ω–æ –º–æ–∂–Ω–æ, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–ª–æ–∂–∏—Ç—å –≤ –≤–µ–∫—Ç–æ—Ä. 

```cpp
using namespace std::chrono_literals;

int main() {

		// —Å –ø–æ–º–æ—â—å—é future –º–æ–∂–Ω–æ –¥–æ—Å—Ç–∞—Ç—å –±—É–¥—É—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
		// –∞ —Å –ø–æ–º–æ—â—å—é promise —ç—Ç–æ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –º–æ–∂–Ω–æ –ø–æ–ª–æ–∂–∏—Ç—å
		std::promise<int> promise;
		auto future = promise.get_future();

		// wait_for –ø–æ–∑–≤–æ–ª—è–µ—Ç –∂–¥–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–µ –≤—Ä–µ–º—è
		if (future.wait_for(1s) == std::future_status::timeout) {
				std::cout << "Timeout" << std::endl;
		}
		
		// —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ future 
		promise.set_value(100);

		if (future.wait_for(1s) == std::future_status::ready) {
				std::cout << "Ready" << future.get() << std::endl;
		}

		return 0;
}

// –í—ã–≤–æ–¥:
// Timeout
// Ready 100
```

–ó–¥–µ—Å—å –º—ã –Ω–µ —Å–æ–∑–¥–∞–≤–∞–ª–∏ –ø–æ—Ç–æ–∫–∏ —è–≤–Ω–æ (–≤—Å—ë –º–æ–≥–ª–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å—Å—è –∏ –≤ –æ–¥–Ω–æ–º –ø–æ—Ç–æ–∫–µ).

–ü–æ—Ç–æ–∫–∏ –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º, –Ω–∞–ø—Ä—è–º—É—é:

```cpp
using namespace std::chrono_literals;

int main() {
		std::cout << std::thread::hardware_concurrency() << std::endl;
		// –≤—ã–≤–æ–¥–∏—Ç —Ñ–∏–∑–∏—á–µ—Å–∫–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ç–æ–∫–æ–≤ (—è–¥–µ—Ä)
		
		std::thread thread1([]() {
				for (size_t i = 0; i < 10; ++i) {
						std::this_thread::sleep_for(100ms);
						std::cout << "Thread 1: " << i << std::endl;
				}
		});

		std::thread thread2([]() {
				for (size_t i = 0; i < 10; ++i) {
						std::this_thread::sleep_for(200ms);
						std::cout << "Thread 2: " << i << std::endl;
				}
		});

		thread1.join();
		thread2.join();
		// join() "–∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç –¥–æ–∂–¥–∞—Ç—å—Å—è", –ø–æ–∫–∞ thread1 –∏ thread2 –Ω–µ –∑–∞–∫–æ–Ω—á–∞—Ç —Ä–∞–±–æ—Ç—É, –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ—Å–Ω–æ–≤–Ω–æ–º—É –ø–æ—Ç–æ–∫—É —É–≤–∏–¥–µ—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ –≤—ã–∑–≤–∞–Ω–Ω—ã—Ö –ø–æ—Ç–æ–∫–∞—Ö

		return 0;
}
```

–°–¥–µ–ª–∞–µ–º —Ç–∞–∫, —á—Ç–æ–±—ã –¥–≤–∞ –ø–æ—Ç–æ–∫–∞ –∏–∑–º–µ–Ω—è–ª–∏ –æ–±—â–∏–π —É—á–∞—Å—Ç–æ–∫ –ø–∞–º—è—Ç–∏:

```cpp
using namespace std::chrono_literals;

int TOTAL_ITERATIONS = 0;

int main() {

		std::thread thread1([]() {
				for (size_t i = 0; i < 10; ++i) {
						++TOTAL_ITERATIONS;
				}
		});

		std::thread thread2([]() {
				for (size_t i = 0; i < 10; ++i) {
						++TOTAL_ITERATIONS;
				}
		});

		thread1.join();
		thread2.join();

		std::cout << TOTAL_ITERATIONS << std::endl;

		return 0;
}

// –í—ã–≤–æ–¥:
// 20
```

–í—ã–≤–æ–¥ –≤–µ—Ä–Ω—ã–π, –Ω–æ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –∫–æ–¥ –Ω–∞–ø–∏—Å–∞–Ω **–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ**!

> –ü–æ—Ç–æ–∫–∏ `thread1` –∏ `thread2` –º–æ–≥—É—Ç –Ω–µ —É–≤–∏–¥–µ—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è, —Å–¥–µ–ª–∞–Ω–Ω—ã–µ –≤ –¥—Ä—É–≥–æ–º –ø–æ—Ç–æ–∫–µ.
> 

–¢–∞–∫–∞—è —Å–∏—Ç—É–∞—Ü–∏—è –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –≥–æ–Ω–∫–æ–π (race condition) –∏ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –∏–º–µ–Ω–Ω–æ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–æ—Ç–æ–∫–æ–≤ —Å –æ–¥–Ω–æ–π –æ–±–ª–∞—Å—Ç—å—é –ø–∞–º—è—Ç–∏. 

–î–æ–ø—É—Å—Ç–∏–º, —É –Ω–∞—Å –µ—Å—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è —Å–æ –∑–Ω–∞—á–µ–Ω–∏–µ–º 100. –û–¥–∏–Ω –ø–æ—Ç–æ–∫ –¥–æ–ª–∂–µ–Ω –ø—Ä–∏–±–∞–≤–∏—Ç—å –∫ –Ω–µ–º—É 10, –∞ –≤—Ç–æ—Ä–æ–π ‚Äî- –≤—ã—á–µ—Å—Ç—å 20. –ú–æ–∂–µ—Ç —Å–ª—É—á–∏—Ç—å—Å—è —Ç–∞–∫, —á—Ç–æ –≤—Ç–æ—Ä–æ–π –ø–æ—Ç–æ–∫ ‚Äú–≤–∫–ª–∏–Ω–∏—Ç—Å—è‚Äù –º–µ–∂–¥—É –Ω–∞—á–∞–ª–æ–º –∏ –∫–æ–Ω—Ü–æ–º —Ä–∞–±–æ—Ç—ã –ø–µ—Ä–≤–æ–≥–æ –ø–æ—Ç–æ–∫–∞ (—ç—Ç–æ –≤–æ–∑–º–æ–∂–Ω–æ, —Ç–∞–∫ –∫–∞–∫ –Ω–∞—à–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω–µ –∞—Ç–æ–º–∞—Ä–Ω—ã–µ, –∞ –∑–∞–Ω–∏–º–∞—é—Ç –∫–∞–∫–æ–µ-—Ç–æ –≤—Ä–µ–º—è). –†–µ–∑—É–ª—å—Ç–∞—Ç–æ–º —Ä–∞–±–æ—Ç—ã –ø–µ—Ä–≤–æ–≥–æ –ø–æ—Ç–æ–∫–∞ –±—É–¥–µ—Ç 90, –≤—Ç–æ—Ä–æ–≥–æ ‚Äî 80. –í–æ-–ø–µ—Ä–≤—ã—Ö, –Ω–∏ –æ–¥–∏–Ω –∏–∑ —ç—Ç–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –≤–µ—Ä–Ω—ã–º. –í–æ-–≤—Ç–æ—Ä—ã—Ö, –º—ã –¥–∞–∂–µ –Ω–µ –º–æ–∂–µ–º –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å, –∫–∞–∫–æ–µ –∏—Ç–æ–≥–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ–ª—É—á–∏–º –≤ –∫–æ–Ω—Ü–µ.

### –ß—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å?

1.  –û–±—ä—è–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `TOTAL_ITERATIONS` –∫–∞–∫ `atomic`:  `std::atomic<int> TOTAL_ITERATIONS = 0`.
    
    –¢–æ–≥–¥–∞ –≤ –æ–¥–Ω–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å `TOTAL_ITERATIONS` –Ω–µ –º–æ–≥—É—Ç ‚Äú–≤–∫–ª–∏–Ω–∏—Ç—å—Å—è‚Äù –¥—Ä—É–≥–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏.  `atomic` –ø–æ–¥—Ö–æ–¥–∏—Ç, –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –∫–∞–∫–æ–π-—Ç–æ —Å—á—ë—Ç—á–∏–∫ –∏–ª–∏ –µ—â—ë –∫–∞–∫–æ–π-—Ç–æ –ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã–π —Ç–∏–ø.
    
2.  –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `std::mutex`. –û–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±–µ—Å–ø–µ—á–∏—Ç—å —É–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ `TOTAL_ITERATIONS` (–≤ –æ–¥–∏–Ω –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏ –¥–æ—Å—Ç—É–ø –∫ `TOTAL_ITERATIONS` –±—É–¥–µ—Ç –∏–º–µ—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –ø–æ—Ç–æ–∫).
    
    ```cpp
    int TOTAL_ITERATIONS = 0;
    std::mutex MUTEX; // –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–µ–Ω –≤–æ –≤—Å–µ—Ö –ø–æ—Ç–æ–∫–∞—Ö
    ...
    int main() {
    		std::thread thread1([]() {
    		    MUTEX.lock();
    				...
    				MUTEX.unlock(); // –Ω—É–∂–Ω–æ –Ω–µ –∑–∞–±—ã—Ç—å –ø–æ–∑–≤–∞—Ç—å unlock() –≤ —ç—Ç–æ–º –∂–µ –ø–æ—Ç–æ–∫–µ, –∏–Ω–∞—á–µ –ø–æ–ª—É—á–∏–º deadlock (–∫–æ–≥–¥–∞ –Ω–∏ –æ–¥–∏–Ω –ø–æ—Ç–æ–∫ –Ω–µ –º–æ–∂–µ—Ç "–∑–∞—Ö–≤–∞—Ç–∏—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫—É")
    				// —ç—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–æ–∏–∑–æ–π—Ç–∏ –∏ –∏–∑-–∑–∞ –≤—ã–∑–æ–≤–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –∏–ª–∏ return
    		});
    		...
    		std::thread thread2([]() {
    		    MUTEX.lock(); // –µ—Å–ª–∏ –ø–µ—Ä–≤—ã–π –ø–æ—Ç–æ–∫ —É–∂–µ –Ω–∞—á–∞–ª –∏ –µ—â—ë –Ω–µ –∑–∞–∫–æ–Ω—á–∏–ª –≤—ã–ø–æ–ª–Ω—è—Ç—å —Å–≤–æ–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏, –≤—Ç–æ—Ä–æ–π –ø–æ—Ç–æ–∫ –Ω–µ —Å–º–æ–∂–µ—Ç –Ω–∞—á–∞—Ç—å –≤—ã–ø–æ–ª–Ω—è—Ç—å —Å–≤–æ–∏
    				...
    				MUTEX.unlock();
    		});
    		...
    }
    ```
    
    –ü—Ä–∏ —ç—Ç–æ–º –Ω–µ—Ç –Ω–∏–∫–∞–∫–æ–π –≥–∞—Ä–∞–Ω—Ç–∏–∏, –∫–∞–∫–æ–π –ø–æ—Ç–æ–∫ ‚Äú–≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è‚Äù –ø–µ—Ä–≤—ã–º. 
    
    –î–ª—è –∏–∑–±–µ–≥–∞–Ω–∏—è deadlock –µ—Å—Ç—å `std::lock_guard` 
    
    ```cpp
    ...
    		std::thread thread1([]() {
    				std::lock_guard lock(MUTEX); // –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–µ –∑–æ–≤—ë—Ç Mutex.lock(), –≤ –¥–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä–µ –∑–æ–≤—ë—Ç Mutex.unlock()
    				...
    		});
    ...
    ```
